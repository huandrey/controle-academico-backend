generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  ADMIN
  ALUNO
  DOCENTE
}

enum SituacaoDisciplina {
  APROVADO
  EM_PROGRESSO
  TRANCADA
  REPROVADO
  DISPENSA
  REPROVADO_POR_FALTA
}

model Universidade {
  id        Int      @id @default(autoincrement())
  sigla     String // 'UFCG', 'UFPB', 'UFRJ'
  nome      String
  cidade    String
  estado    String
  createdAt DateTime @default(now())
}

model Usuario {
  id        Int      @id @default(autoincrement())
  nome      String
  token     String?
  role      Role     @default(ALUNO)
  aluno     Aluno?
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model Aluno {
  id                 Int          @id @default(autoincrement())
  usuarioId          Int          @unique
  nome               String
  matricula          String       @unique @db.VarChar(9)
  curso              String       @default("Ciência da Computação")
  universidade       String       @default("Universidade Federal de Campina Grande")
  usuario            Usuario      @relation(fields: [usuarioId], references: [id])
  historicoAcademico Disciplina[]
  createdAt          DateTime     @default(now())
  updatedAt          DateTime     @default(now())
}

model Disciplina {
  id               Int                 @id @default(autoincrement())
  codigo           String
  nome             String
  creditos         Int
  cargaHoraria     Int                 @default(0)
  semestre         String
  situacao         SituacaoDisciplina? @default(EM_PROGRESSO)
  quantidadeProvas Int
  quantidadeFaltas Int
  mediaFinal       Float?
  docente          String              @default("Desconhecido")
  alunoId          Int?
  aluno            Aluno?              @relation(fields: [alunoId], references: [id])
  horario          String?
  createdAt        DateTime            @default(now())
}
